import win32com.client

def resolve_by_alias(alias, namespace):
    r = namespace.CreateRecipient(alias)
    r.Resolve()
    if r.Resolved:
        return r.AddressEntry.GetExchangeUser()
    return None

def resolve_by_email(email, namespace):
    r = namespace.CreateRecipient(email)
    r.Resolve()
    if r.Resolved:
        return r.AddressEntry.GetExchangeUser()
    return None

def resolve_by_name(name, namespace):
    r = namespace.CreateRecipient(name)
    r.Resolve()
    if r.Resolved:
        return r.AddressEntry.GetExchangeUser()
    return None

def resolve(identifier):
    outlook   = win32com.client.Dispatch("Outlook.Application")
    namespace = outlook.GetNamespace("MAPI")

    user = None

    # 1) Try alias (Employee ID)
    user = resolve_by_alias(identifier, namespace)

    # 2) Try email address
    if not user and "@" in identifier:
        user = resolve_by_email(identifier, namespace)

    # 3) Finally try display name
    if not user:
        user = resolve_by_name(identifier, namespace)

    if not user:
        print(f"‚ùå Could not resolve: {identifier!r}")
        return

    # Print out the info
    print(f"Name:               {user.Name}")
    print(f"Email:              {user.PrimarySmtpAddress}")
    print(f"Job Title:          {user.JobTitle}")
    print(f"Employee ID (Alias): {user.Alias}")

if __name__ == "__main__":
    ident = input("Enter Employee ID, Email or Name: ").strip()
    resolve(ident)