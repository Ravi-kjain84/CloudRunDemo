def export_hierarchy_flat_view(self, output_file):
    flat_records = []
    unresolved_ids = []

    print(f"\nExporting hierarchy for {len(self.input_emp_ids)} Employee IDs...\n")

    found_ids = set()
    for node in self.nodes.values():
        if node.emp_id in self.input_emp_ids:
            found_ids.add(node.emp_id)
            chain = node.get_chain_upwards()
            row = {
                "Original Employee ID": node.emp_id
            }
            for i, level in enumerate(chain):
                row[f"Level {i} Name"] = level["Name"]
                row[f"Level {i} Title"] = level["Title"]
                row[f"Level {i} Email"] = level["Email"]
                row[f"Level {i} Employee ID"] = level["Employee ID"]

            departments = self.resolve_multi_level_departments(chain)
            for idx, dept in enumerate(departments):
                row[f"Department Level {idx+1}"] = dept

            flat_records.append(row)

    # Log unresolved employee IDs
    unresolved_ids = self.input_emp_ids - found_ids
    if unresolved_ids:
        print(f"Warning: {len(unresolved_ids)} Employee ID(s) not found in hierarchy:")
        for eid in unresolved_ids:
            print(f"  - Missing: {eid}")

    df_flat = pd.DataFrame(flat_records)
    df_flat.to_excel(output_file, index=False)
    print(f"\nExported {len(flat_records)} rows to {output_file}")
    return df_flat