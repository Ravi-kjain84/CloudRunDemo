def enforce_schema(df: pd.DataFrame, schema: list[bigquery.SchemaField]) -> pd.DataFrame:
    """
    Ensures the DataFrame's column types match the expected BigQuery schema.
    Casts columns where needed to STRING, FLOAT, INT64, or TIMESTAMP.
    """
    for field in schema:
        col = field.name
        bq_type = field.field_type.upper()

        if col not in df.columns:
            continue  # skip missing columns

        if bq_type == "STRING":
            df[col] = df[col].astype(str)
        elif bq_type == "FLOAT":
            df[col] = pd.to_numeric(df[col], errors='coerce')
        elif bq_type == "INT64":
            df[col] = pd.to_numeric(df[col], errors='coerce').astype("Int64")
        elif bq_type == "TIMESTAMP":
            df[col] = pd.to_datetime(df[col], errors='coerce')
        # Add more types as needed (e.g., BOOLEAN, DATE)
    return df