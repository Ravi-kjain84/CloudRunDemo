import os
from openpyxl import Workbook

def write_testcase_wise_workbooks(test_evidence, test_cases):
    # Create output directory if it doesn't exist
    output_dir = "output/testcases"
    os.makedirs(output_dir, exist_ok=True)

    for test_case_id, evidence in test_evidence.items():
        wb = Workbook()
        ws = wb.active
        ws.title = str(test_case_id)

        # Write the test case content to the sheet
        write_test_case_block(ws, test_case_id, evidence, test_cases)

        # Save workbook to output/testcases/ folder
        filename = os.path.join(output_dir, f"TestEvidence_{test_case_id}.xlsx")
        wb.save(filename)
        print(f"Saved workbook for test case {test_case_id} to {filename}")