import pandas as pd
import os

def generate_input_employees():
    # Determine the current script folder
    base_dir = os.path.dirname(os.path.abspath(__file__))

    # File paths
    jira_logs_path = os.path.join(base_dir, "jira_logs.csv")
    output_path = os.path.join(base_dir, "input_employees.xlsx")

    # Read the source file
    df = pd.read_csv(jira_logs_path, dtype=str)

    # Select required columns and drop blank rows
    df_filtered = df[["assignee_email_id", "assignee_employee_id", "assignee"]].dropna(how="any")

    # Remove duplicates
    df_filtered = df_filtered.drop_duplicates()

    # Rename columns
    df_filtered.columns = ["Email", "Employee ID", "Name"]

    # Write to Excel (Sheet1)
    df_filtered.to_excel(output_path, index=False, sheet_name="Sheet1")

    print(f"Input employees file generated: {output_path}")