let
  // load & type
  Source      = Excel.Workbook(File.Contents("C:\Path\RawHierarchy.xlsx"), null, true){[Name="EmployeeHierarchy"]}[Data],
  Promoted    = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
  Typed       = Table.TransformColumnTypes(Promoted, {{"EmployeeID", type text}, {"ManagerID", type text}}),

  // recursive function to fetch all descendants
  GetDescendants = (mgr as text) as list =>
    let
      Direct  = Table.SelectRows(Typed, each [ManagerID]=mgr)[EmployeeID],
      Indir   = List.Combine(List.Transform(Direct, each @GetDescendants(_))),
      Combined= List.Distinct(List.Combine({Direct, Indir}))
    in
      Combined,

  // build summary table
  DistinctMgrs = List.RemoveNulls(List.Distinct(Typed[ManagerID])),
  Summaries   = List.Transform(
    DistinctMgrs,
    (mgr) => [
      ManagerID        = mgr,
      DirectReportees  = List.Count(Table.SelectRows(Typed, each [ManagerID]=mgr)[EmployeeID]),
      TotalReportees   = List.Count(GetDescendants(mgr)),
      IndirectReportees= List.Count(GetDescendants(mgr)) 
                        - List.Count(Table.SelectRows(Typed, each [ManagerID]=mgr)[EmployeeID])
    ]
  ),
  ResultTable = Table.FromRecords(Summaries)
in
  ResultTable