import win32com.client

def inspect_user_properties(name_or_email):
    outlook = win32com.client.Dispatch("Outlook.Application")
    namespace = outlook.GetNamespace("MAPI")
    
    try:
        recipient = namespace.CreateRecipient(name_or_email)
        user = recipient.AddressEntry.GetExchangeUser()

        if not user:
            print("User not found.")
            return

        print(f"Name: {user.Name}")
        print(f"Email: {user.PrimarySmtpAddress}")
        print(f"Title: {user.JobTitle}")

        # Try known properties where Employee ID may reside
        try:
            print(f"EmployeeID (user.EmployeeID): {user.EmployeeID}")
        except Exception:
            print("EmployeeID not accessible.")

        try:
            print(f"ID (user.ID): {user.ID}")
        except Exception:
            print("ID not accessible.")

        try:
            print(f"Alias (user.Alias): {user.Alias}")
        except Exception:
            print("Alias not accessible.")

        try:
            print(f"BusinessTelephoneNumber: {user.BusinessTelephoneNumber}")
        except Exception:
            pass

        try:
            print(f"OfficeLocation: {user.OfficeLocation}")
        except Exception:
            pass

        # Attempt to enumerate all available attributes
        print("\n--- All Available Properties ---")
        for attr in dir(user):
            if not attr.startswith("_"):
                try:
                    value = getattr(user, attr)
                    if not callable(value):
                        print(f"{attr}: {value}")
                except:
                    continue

    except Exception as e:
        print(f"Error resolving user: {e}")

# Test with known name or email
inspect_user_properties("Rakesh Sharma")