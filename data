outlook = win32.Dispatch("Outlook.Application")
namespace = outlook.GetNamespace("MAPI")

# Pick Testing CoE mailbox
recipient = namespace.CreateRecipient("Testing CoE")  # Name exactly as shown in Outlook
recipient.Resolve()

if not recipient.Resolved:
    raise Exception("[ERROR] Could not resolve Testing CoE mailbox.")

# Get the Inbox of Testing CoE
inbox = namespace.GetSharedDefaultFolder(recipient, 6)  # 6 = Inbox

parent_folder = inbox.Parent  # Parent folder now is Testing CoE mailbox

# Now find the target folder inside Testing CoE mailbox
target_folder = None
for folder in parent_folder.Folders:
    if folder.Name == TARGET_FOLDER_NAME:
        target_folder = folder
        break

if not target_folder:
    raise Exception(f"[ERROR] Folder '{TARGET_FOLDER_NAME}' not found in Testing CoE mailbox.")