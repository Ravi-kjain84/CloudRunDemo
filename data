import re
from docx import Document

def convert_vtt_to_text(vtt_file_path):
    output_lines = []
    with open(vtt_file_path, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    for line in lines:
        if re.match(r"^\s*$", line):
            continue
        if re.match(r"^\d{2}:\d{2}:\d{2}\.\d{3} -->", line):
            continue
        if re.match(r"^[\w-]{36}", line.strip()):
            continue
        output_lines.append(line.strip())

    return ' '.join(output_lines)

def save_to_docx(text, docx_path):
    doc = Document()
    doc.add_paragraph(text)
    doc.save(docx_path)

def save_to_txt(text, txt_path):
    with open(txt_path, 'w', encoding='utf-8') as f:
        f.write(text)

# Example usage
vtt_file = "your_file.vtt"           # Replace with actual VTT file path
docx_file = "output.docx"            # Desired output Word file
txt_file = "output.txt"              # Desired output text file

final_text = convert_vtt_to_text(vtt_file)
save_to_docx(final_text, docx_file)
save_to_txt(final_text, txt_file)