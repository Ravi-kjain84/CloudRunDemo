import subprocess
import sys
from datetime import datetime

def run_script(script_name):
    print(f"\n[{datetime.now()}] Running script: {script_name}")
    result = subprocess.run([sys.executable, script_name], capture_output=True, text=True)

    if result.returncode == 0:
        print(f"[{datetime.now()}] {script_name} completed successfully.")
    else:
        print(f"[{datetime.now()}] ERROR: {script_name} failed.")
        print("----- STDERR -----")
        print(result.stderr)
        print("----- STDOUT -----")
        print(result.stdout)
        sys.exit(1)

def print_environment_info():
    print(f"Python executable in use: {sys.executable}")
    try:
        import pandas
        print(f"Pandas version: {pandas.__version__}")
    except ImportError:
        print("ERROR: 'pandas' is not installed in this environment.")
        sys.exit(1)

# Main Execution
print_environment_info()

# Run scripts in order
run_script("jira_csv_writer.py")
run_script("JIRA_KPIs_04.py")
run_script("bq_loader_modular.py")

print("\nAll scripts ran successfully.")