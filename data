import os

def upload_file_to_bq(
    file_path: str,
    bq_table_name: str,
    dataset_name: str,
    project: str,
    schema=None,
    force_refresh: bool = False,
    auto_detect: bool = True
):
    ext = os.path.splitext(file_path)[-1].lower()

    if ext in [".xlsx", ".xls"]:
        # Excel Upload
        upload_excel_to_bq(
            excel_file_path=file_path,
            bq_table_name=bq_table_name,
            dataset_name=dataset_name,
            project=project,
            force_refresh=force_refresh,
            auto_detect=auto_detect
        )
    elif ext == ".csv":
        # CSV Upload
        upload_csv_to_bq(
            csv_file_path=file_path,
            bq_table_name=bq_table_name,
            schema=schema,
            force_refresh=force_refresh,
            auto_detect=auto_detect
        )
    else:
        raise ValueError("Unsupported file format. Use .csv or .xlsx/.xls")