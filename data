Sub Refresh_Selected_PowerQueries()
    Dim ws As Worksheet
    Dim qt As QueryTable
    Dim lo As ListObject
    Dim con As WorkbookConnection
    Dim QueriesToRefresh As Variant
    Dim qName As Variant
    
    ' === List your Query or Table names below ===
    QueriesToRefresh = Array("Query1", "Query2") ' <-- Update these names
    
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    Application.EnableEvents = False
    
    ' Refresh selected Connections
    For Each con In ThisWorkbook.Connections
        For Each qName In QueriesToRefresh
            If con.Name = qName Then
                con.Refresh
            End If
        Next qName
    Next con

    ' Refresh selected Tables
    For Each ws In ThisWorkbook.Worksheets
        For Each lo In ws.ListObjects
            On Error Resume Next
            If Not lo.QueryTable Is Nothing Then
                For Each qName In QueriesToRefresh
                    If lo.Name = qName Then
                        lo.QueryTable.Refresh BackgroundQuery:=False
                    End If
                Next qName
            End If
            On Error GoTo 0
        Next lo
    Next ws

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Application.EnableEvents = True

    MsgBox "Selected Power Queries and Tables Refreshed Successfully!", vbInformation
End Sub