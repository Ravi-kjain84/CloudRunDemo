import pandas as pd

# Load your data
df = pd.read_excel('your_file.xlsx')  # Adjust file name

# Build Employee → Manager Map
emp_mgr_map = dict(zip(df['Employee_Name'], df['Manager_Name_L1']))

# Recursive function to find full path
def get_full_path(employee):
    path = [employee]
    while employee in emp_mgr_map and pd.notna(emp_mgr_map[employee]) and emp_mgr_map[employee] != employee:
        manager = emp_mgr_map[employee]
        path.append(manager)
        employee = manager
    return " → ".join(path)

# Apply to all employees
df['Management_Path'] = df['Employee_Name'].apply(get_full_path)

# Count hierarchy level
df['Hierarchy_Level'] = df['Management_Path'].str.count('→')

# Save
df.to_excel('output_full_hierarchy.xlsx', index=False)